---
import { getCollection } from 'astro:content';
import '../../styles/global.css';

// 1. ì •ì  ê²½ë¡œ ìƒì„± (ë¯¸ë¦¬ í˜ì´ì§€ë¥¼ ë‹¤ ë§Œë“¤ì–´ë‘ )
export async function getStaticPaths() {
  const spots = await getCollection('spots');
  return spots.map(spot => ({
    params: { slug: spot.slug },
    props: { spot },
  }));
}

const { spot } = Astro.props;
const { Content } = await spot.render();
---

<html lang="ko">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{spot.data.title} - ì§€ë¦¬ì‚° ê´€ê´‘ì§€</title>
</head>
<body class="bg-white text-slate-800">

    <!-- ìƒë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
    <header class="sticky top-0 bg-white/90 backdrop-blur-sm border-b border-slate-100 z-50 px-4 py-3 flex items-center">
        <a href="/" class="text-lg mr-4">ğŸ”™</a>
        <h1 class="text-base font-bold truncate">{spot.data.title}</h1>
    </header>

    <main class="pb-10">
        <!-- ëŒ€í‘œ ì´ë¯¸ì§€ -->
        <div class="w-full h-64 bg-slate-100 relative">
            {spot.data.image ? (
                <img src={spot.data.image} alt={spot.data.title} class="w-full h-full object-cover" />
            ) : (
                <div class="w-full h-full flex items-center justify-center text-4xl">ğŸï¸</div>
            )}
            <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-4 pt-20">
                <div class="flex gap-2 mb-1">
                    <span class="text-xs bg-white/20 text-white px-2 py-0.5 rounded backdrop-blur-md">{spot.data.region}</span>
                    <span class="text-xs bg-white/20 text-white px-2 py-0.5 rounded backdrop-blur-md">{spot.data.category}</span>
                </div>
                <h2 class="text-2xl font-bold text-white shadow-sm">{spot.data.title}</h2>
            </div>
        </div>

        <!-- ê¸°ë³¸ ì •ë³´ -->
        <div class="p-5 border-b border-slate-100">
            <div class="flex items-center justify-between mb-2">
                <span class="text-sm font-bold text-slate-500">íƒë°©ì›ì—ì„œì˜ ê±°ë¦¬</span>
                <span class="text-lg font-bold text-green-700">ğŸš— {spot.data.distance}km <span class="text-sm font-normal text-slate-400">({spot.data.time})</span></span>
            </div>
            <p class="text-sm text-slate-600 flex items-start gap-1">
                ğŸ“ <span class="flex-1">{spot.data.address}</span>
            </p>
        </div>

        <!-- ë³¸ë¬¸ ë‚´ìš© -->
        <div class="p-5 prose prose-slate prose-sm max-w-none">
            <Content />
        </div>

        <!-- í•˜ë‹¨ ê²€ìƒ‰ ë²„íŠ¼ -->
        <div class="p-5 space-y-3 bg-slate-50 mt-5">
            <p class="text-xs text-center text-slate-400 mb-2">ë” ìì„¸í•œ ì •ë³´ê°€ ê¶ê¸ˆí•˜ë‹¤ë©´?</p>
            <a href={`https://www.google.com/search?q=${spot.data.region} ${spot.data.title}`} target="_blank" class="block w-full py-3 bg-white border border-slate-300 rounded-lg text-center text-sm font-bold text-slate-700 hover:bg-slate-50 transition">
                G êµ¬ê¸€ì—ì„œ ê²€ìƒ‰í•˜ê¸°
            </a>
            <a href={`https://www.youtube.com/results?search_query=${spot.data.region} ${spot.data.title}`} target="_blank" class="block w-full py-3 bg-white border border-slate-300 rounded-lg text-center text-sm font-bold text-slate-700 hover:bg-slate-50 transition">
                ğŸ“º ìœ íŠœë¸Œ ì˜ìƒ ì°¾ì•„ë³´ê¸°
            </a>
            <a href={`https://exam1-beige.vercel.app/?q=${spot.data.title}`} target="_blank" class="block w-full py-3 bg-green-600 text-white rounded-lg text-center text-sm font-bold shadow-sm hover:bg-green-700 transition">
                ğŸ›ï¸ êµ­ê°€ìœ ì‚° ì •ë³´ ë³´ê¸°
            </a>
        </div>
    </main>

</body>
</html>